{% extends "base.html" %} {% block content %}

<div class="row justify-content-center">
  <div class="col-lg-10">
    <h2 class="display-5 fw-bold mb-4" style="color: var(--purple-dark)">
      Meu Carrinho de Compras
    </h2>

    {% if not itens_carrinho %}
    <div class="alert alert-info text-center">
      O seu carrinho está vazio. Comece a comprar!
      <p class="mt-2">
        <a href="{{ url_for('auth.home') }}" class="alert-link"
          >Ver restaurantes</a
        >
      </p>
    </div>
    {% else %}

    <div class="card shadow-lg mb-4">
      <div
        class="card-header bg-purple text-white"
        style="background-color: var(--purple-dark) !important"
      >
        <h5 class="mb-0 fw-bold">
          Itens de {{ restaurante_id }} (Restaurante ID)
        </h5>
      </div>
      <div class="card-body p-0">
        <table class="table table-striped mb-0 align-middle">
          <thead>
            <tr>
              <th style="width: 100px">Foto</th>
              <th>Produto</th>
              <th class="text-end">Preço Unit.</th>
              <th class="text-center">Quantidade</th>
              <th class="text-end">Subtotal</th>
              <th class="text-center">Ações</th>
            </tr>
          </thead>
          <tbody>
            {% for item in itens_carrinho %}
            <tr>
              <td>
                {% if item.imagem %}
                <img
                  src="{{ item.imagem }}"
                  alt="{{ item.nome }}"
                  style="
                    width: 60px;
                    height: 60px;
                    object-fit: cover;
                    border-radius: 8px;
                  "
                />
                {% else %}
                <div
                  style="
                    width: 60px;
                    height: 60px;
                    background-color: #eee;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                  "
                >
                  <i class="fas fa-utensils text-muted"></i>
                </div>
                {% endif %}
              </td>

              <td>{{ item.nome }}</td>
              <td class="text-end">R$ {{ "%.2f"|format(item.preco) }}</td>
              <td class="text-center">{{ item.quantidade }}</td>
              <td class="text-end">R$ {{ "%.2f"|format(item.subtotal) }}</td>
              <td class="text-center">
                <form
                  method="POST"
                  action="{{ url_for('auth.remove_from_cart', produto_id=item.id) }}"
                  style="display: inline"
                >
                  <button type="submit" class="btn btn-sm btn-outline-danger">
                    <i class="fas fa-trash"></i>
                  </button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
          <tfoot>
            <tr class="fw-bold table-light">
              <td colspan="4" class="text-end">Total dos Produtos:</td>
              <td colspan="2" class="text-end">
                R$ {{ "%.2f"|format(total_carrinho) }}
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <div class="d-flex justify-content-between align-items-center">
      <p class="mt-2">
        <a
          href="{{ url_for('auth.view_restaurant', restaurante_id=restaurante_id) }}"
          >← Adicionar mais itens</a
        >
      </p>

      <a
        href="{{ url_for('auth.checkout') }}"
        class="btn btn-lg btn-success fw-bold"
        style="background-color: var(--purple-light) !important"
      >
        <i class="fas fa-shopping-cart me-2"></i> Ir para o Checkout
      </a>
    </div>

    {% endif %}
  </div>
</div>

{% endblock content %}
