{% extends "base.html" %} {% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <h2 class="display-5 fw-bold mb-4" style="color: var(--purple-dark)">
      Gerir Meus Endereços
    </h2>

    <h3 class="h4 mb-3" style="color: var(--purple-light)">Endereços Salvos</h3>

    {% if not enderecos %}
    <div class="alert alert-info">
      Você ainda não tem endereços salvos. Use o formulário abaixo para
      adicionar.
    </div>
    {% else %}
    <div class="row">
      {% for endereco in enderecos %}
      <div class="col-md-6 mb-3">
        <div
          class="card p-3 shadow-sm h-100"
          style="border: 1px solid var(--purple-light)"
        >
          <div class="card-body p-2">
            <h5 class="card-title fw-bold">
              {{ endereco.rua }}, {{ endereco.numero }}
            </h5>
            <p class="card-text mb-1">
              {{ endereco.bairro }}, {{ endereco.cidade }} - {{ endereco.estado
              }}
            </p>
            <p class="card-text text-muted small">
              CEP: {{ endereco.cep }} {% if endereco.complemento %}({{
              endereco.complemento }}){% endif %}
            </p>

            <form
              method="POST"
              action="{{ url_for('client.delete_address', endereco_id=endereco.id) }}"
              style="display: inline"
              class="mt-2"
            >
              <button
                type="submit"
                class="btn btn-sm btn-outline-danger"
                onclick="return confirm('Tem a certeza que quer apagar este endereço?')"
              >
                <i class="fas fa-trash-alt"></i> Apagar
              </button>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <hr class="my-5" />

    <h3 class="h4 mb-3" style="color: var(--purple-dark)">
      Adicionar Novo Endereço (ViaCEP Ativo)
    </h3>

    <form method="POST" action="">
      {{ form.hidden_tag() }}

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="cep" class="form-label">{{ form.cep.label }}</label>
          {{ form.cep(class="form-control", id="cep", placeholder="Apenas
          números") }} {% for error in form.cep.errors %}
          <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
      </div>

      <div class="row">
        <div class="col-md-8 mb-3">
          <label for="rua" class="form-label">{{ form.rua.label }}</label>
          {{ form.rua(class="form-control", id="rua") }}
        </div>
        <div class="col-md-4 mb-3">
          <label for="numero" class="form-label">{{ form.numero.label }}</label>
          {{ form.numero(class="form-control", id="numero") }}
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="bairro" class="form-label">{{ form.bairro.label }}</label>
          {{ form.bairro(class="form-control", id="bairro") }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="complemento" class="form-label"
            >{{ form.complemento.label }}</label
          >
          {{ form.complemento(class="form-control", id="complemento",
          placeholder="Apto, Bloco, etc.") }}
        </div>
      </div>

      <div class="row">
        <div class="col-md-8 mb-3">
          <label for="cidade" class="form-label">{{ form.cidade.label }}</label>
          {{ form.cidade(class="form-control", id="cidade") }}
        </div>
        <div class="col-md-4 mb-3">
          <label for="uf" class="form-label">{{ form.estado.label }}</label>
          {{ form.estado(class="form-control", id="uf", placeholder="Ex: SP") }}
        </div>
      </div>

      <div class="d-grid mt-4">
        {{ form.submit(class="btn btn-purple btn-lg", style="background-color:
        var(--purple-dark);") }}
      </div>
    </form>

    <p class="text-center mt-3">
      <a href="{{ url_for('client.profile') }}">← Voltar ao Meu Perfil</a>
    </p>
  </div>
</div>
{% endblock content %}
